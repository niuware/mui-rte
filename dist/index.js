"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),React__default=_interopDefault(React),Immutable=_interopDefault(require("immutable")),classNames=_interopDefault(require("classnames")),styles$5=require("@material-ui/core/styles"),core=require("@material-ui/core"),draftJs=require("draft-js"),FormatBoldIcon=_interopDefault(require("@material-ui/icons/FormatBold")),FormatItalicIcon=_interopDefault(require("@material-ui/icons/FormatItalic")),FormatUnderlinedIcon=_interopDefault(require("@material-ui/icons/FormatUnderlined")),StrikethroughIcon=_interopDefault(require("@material-ui/icons/StrikethroughS")),HighlightIcon=_interopDefault(require("@material-ui/icons/Highlight")),TitleIcon=_interopDefault(require("@material-ui/icons/Title")),InsertLinkIcon=_interopDefault(require("@material-ui/icons/InsertLink")),PhotoLibraryIcon=_interopDefault(require("@material-ui/icons/PhotoLibrary")),FormatListNumberedIcon=_interopDefault(require("@material-ui/icons/FormatListNumbered")),FormatListBulletedIcon=_interopDefault(require("@material-ui/icons/FormatListBulleted")),FormatQuoteIcon=_interopDefault(require("@material-ui/icons/FormatQuote")),CodeIcon=_interopDefault(require("@material-ui/icons/Code")),FormatClearIcon=_interopDefault(require("@material-ui/icons/FormatClear")),SaveIcon=_interopDefault(require("@material-ui/icons/Save")),UndoIcon=_interopDefault(require("@material-ui/icons/Undo")),RedoIcon=_interopDefault(require("@material-ui/icons/Redo")),ButtonGroup=_interopDefault(require("@material-ui/core/ButtonGroup")),InsertPhotoIcon=_interopDefault(require("@material-ui/icons/InsertPhoto")),MovieIcon=_interopDefault(require("@material-ui/icons/Movie")),CheckIcon=_interopDefault(require("@material-ui/icons/Check")),DeleteIcon=_interopDefault(require("@material-ui/icons/DeleteOutline")),FormatAlignCenter=_interopDefault(require("@material-ui/icons/FormatAlignCenter")),FormatAlignLeft=_interopDefault(require("@material-ui/icons/FormatAlignLeft")),FormatAlignRight=_interopDefault(require("@material-ui/icons/FormatAlignRight")),__assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ToolbarButton=function(t){var e=t.inlineMode?"small":"medium",n=t.inlineMode?"-toolbar":"",o=t.id+n,a={id:o,onMouseDown:function(e){e.preventDefault(),t.onClick&&t.onClick(t.style,t.type,o,t.inlineMode)},disabled:t.disabled||!1};return t.icon?React__default.createElement(core.IconButton,__assign({},a,{"aria-label":t.label,color:t.active?"primary":"default",size:e}),t.icon):t.component?React__default.createElement(t.component,__assign({},a,{active:t.active||!1})):null},getSelectionInfo=function(e){var t=e.getSelection(),n=t.getStartOffset(),o=e.getCurrentContent(),a=o.getBlockForKey(t.getStartKey()),r=e.getCurrentInlineStyle(),i=a.getEntityAt(n),l=null;i&&(l=o.getEntity(i).getType());return{inlineStyle:r,blockType:a.getType(),entityType:l,linkKey:i,block:a}},getCompatibleSpacing=function(e,t,n,o,a){if("function"==typeof e)return e(t,n,o,a);var r=e.unit;return t*r+"px "+n*r+"px "+o*r+"px "+a*r+"px"},removeBlockFromMap=function(e,t){var n=e.getCurrentContent(),o=draftJs.Modifier.removeRange(n,new draftJs.SelectionState({anchorKey:t.getKey(),anchorOffset:0,focusKey:t.getKey(),focusOffset:t.getLength()}),"backward"),a=o.getBlockMap().delete(t.getKey());return o.merge({blockMap:a,selectionAfter:n.getSelectionAfter()})},atomicBlockExists=function(t,e){if(e)return e.find(function(e){return"atomic"===e.type&&e.name===t&&void 0!==e.atomicComponent})},STYLE_TYPES=[{label:"H2",name:"title",style:"header-two",icon:React__default.createElement(TitleIcon,null),type:"block"},{label:"Bold",name:"bold",style:"BOLD",icon:React__default.createElement(FormatBoldIcon,null),type:"inline"},{label:"Italic",name:"italic",style:"ITALIC",icon:React__default.createElement(FormatItalicIcon,null),type:"inline"},{label:"Underline",name:"underline",style:"UNDERLINE",icon:React__default.createElement(FormatUnderlinedIcon,null),type:"inline"},{label:"Strikethrough",name:"strikethrough",style:"STRIKETHROUGH",icon:React__default.createElement(StrikethroughIcon,null),type:"inline"},{label:"Highlight",name:"highlight",style:"HIGHLIGHT",icon:React__default.createElement(HighlightIcon,null),type:"inline"},{label:"Undo",name:"undo",style:"UNDO",icon:React__default.createElement(UndoIcon,null),type:"callback"},{label:"Redo",name:"redo",style:"REDO",icon:React__default.createElement(RedoIcon,null),type:"callback"},{label:"Link",name:"link",style:"LINK",icon:React__default.createElement(InsertLinkIcon,null),type:"callback",id:"mui-rte-link-control"},{label:"Media",name:"media",style:"IMAGE",icon:React__default.createElement(PhotoLibraryIcon,null),type:"callback",id:"mui-rte-media-control"},{label:"OL",name:"bulletList",style:"ordered-list-item",icon:React__default.createElement(FormatListNumberedIcon,null),type:"block"},{label:"UL",name:"numberList",style:"unordered-list-item",icon:React__default.createElement(FormatListBulletedIcon,null),type:"block"},{label:"Blockquote",name:"quote",style:"blockquote",icon:React__default.createElement(FormatQuoteIcon,null),type:"block"},{label:"Code Block",name:"code",style:"code-block",icon:React__default.createElement(CodeIcon,null),type:"block"},{label:"Clear",name:"clear",style:"clear",icon:React__default.createElement(FormatClearIcon,null),type:"callback"},{label:"Save",name:"save",style:"save",icon:React__default.createElement(SaveIcon,null),type:"callback"}],Toolbar=function(r){var e=React.useState(r.controls?[]:STYLE_TYPES),t=e[0],n=e[1],i=r.editorState,o=r.inlineMode?"-inline-toolbar":"-toolbar";return React.useEffect(function(){if(r.controls){var o=[];r.controls.filter(function(e,t){return r.controls.indexOf(e)>=t}).forEach(function(t){var e=STYLE_TYPES.find(function(e){return e.name===t});if(e)o.push(e);else if(r.customControls){var n=r.customControls.find(function(e){return e.name===t});n&&"atomic"!==n.type&&(n.icon||n.component)&&o.push({id:n.id||n.name+"Id",name:n.name,label:n.name,style:n.name.toUpperCase(),icon:n.icon,component:n.component,type:n.type,clickFnName:"onCustomClick"})}}),n(o)}},[r.controls,r.customControls]),React__default.createElement("div",{id:r.id+o,className:r.className},t.map(function(e){if(r.inlineMode&&"inline"!==e.type&&"link"!==e.name&&"clear"!==e.name)return null;var t=!1,n=r.onClick;if("inline"===e.type)t=i.getCurrentInlineStyle().has(e.style);else if("block"===e.type){var o=i.getSelection(),a=i.getCurrentContent().getBlockForKey(o.getStartKey());a&&(t=e.style===a.getType())}else"IMAGE"!==e.style&&"LINK"!==e.style||(t=e.style===getSelectionInfo(i).entityType);return React__default.createElement(ToolbarButton,{id:e.id,key:"key-"+e.label,active:t,label:e.label,onClick:n,style:e.style,type:e.type,icon:e.icon,component:e.component,inlineMode:r.inlineMode,disabled:r.disabled})}))},Link=function(e){var t=e.contentState.getEntity(e.entityKey).getData().url;return React.createElement("a",{href:t,style:{textDecoration:"underline",color:"inherit"},className:"editor-anchor",target:"_blank"},e.children)},styles=function(e){var t=e.shadows;return styles$5.createStyles({root:{margin:"5px 0 1px",outline:"none"},editable:{cursor:"pointer","&:hover":{boxShadow:t[3]}},focused:{boxShadow:t[3]},centered:{textAlign:"center"},leftAligned:{textAlign:"left"},rightAligned:{textAlign:"right"}})},Media=function(e){var t,n,o,a=e.contentState.getEntity(e.block.getEntityAt(0)).getData(),r=a.url,i=a.width,l=a.height,c=a.alignment,u=a.type,s=e.blockProps,d=s.onClick,f=s.readOnly,m=s.focusKey;return React__default.createElement("div",{className:classNames((t={},t[e.classes.centered]="center"===c,t[e.classes.leftAligned]="left"===c,t[e.classes.rightAligned]="right"===c,t))},(o={src:r,className:classNames(e.classes.root,(n={},n[e.classes.editable]=!f,n[e.classes.focused]=!f&&m===e.block.getKey(),n)),width:i,height:"video"===u?"auto":l,onClick:function(){f||d(e.block)}},u&&"image"!==u?"video"===u?React__default.createElement("video",__assign({},o,{autoPlay:!1,controls:!0})):null:React__default.createElement("img",__assign({},o))))},Media$1=styles$5.withStyles(styles,{withTheme:!0})(Media),styles$1=function(e){var t=e.palette;return styles$5.createStyles({root:{fontStyle:"italic",color:t.grey[800],borderLeft:"4px solid "+t.grey.A100}})},Blockquote=function(e){return React.createElement("div",{className:e.classes.root},e.children)},Blockquote$1=styles$5.withStyles(styles$1,{withTheme:!0})(Blockquote),styles$2=function(e){var t=e.spacing,n=e.palette;return styles$5.createStyles({root:{backgroundColor:n.grey[200],padding:getCompatibleSpacing(t,1,2,1,2)}})},CodeBlock=function(e){return React.createElement("div",{className:e.classes.root},e.children)},CodeBlock$1=styles$5.withStyles(styles$2,{withTheme:!0})(CodeBlock),styles$3=function(e){var t=e.spacing;return styles$5.createStyles({linkPopover:{padding:getCompatibleSpacing(t,2,2,2,2),maxWidth:250},linkTextField:{width:"100%"}})},UrlPopover=function(e){function t(e,t){var n,o;if(""!==e){var a=parseInt(e,10);isNaN(a)||i(__assign(__assign({},r),((o={})[t]=a,o)))}else i(__assign(__assign({},r),((n={})[t]=void 0,n)))}var n=React.useState(e.data||{url:void 0,width:void 0,height:void 0,alignment:void 0,type:void 0}),r=n[0],i=n[1],o=e.classes;return React__default.createElement(core.Popover,{open:void 0!==e.anchor,anchorEl:e.anchor,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},React__default.createElement("div",{className:o.linkPopover},React__default.createElement(core.Grid,{container:!0,spacing:1},React__default.createElement(core.Grid,{container:!0,item:!0,xs:!0,spacing:1},React__default.createElement(core.Grid,{item:!0,xs:12},React__default.createElement(core.TextField,{className:o.linkTextField,onChange:function(e){return i(__assign(__assign({},r),{url:e.target.value}))},label:"URL",defaultValue:e.data&&e.data.url,autoFocus:!0,InputLabelProps:{shrink:!0}})),e.isMedia?React__default.createElement(React__default.Fragment,null,React__default.createElement(core.Grid,{item:!0,xs:12},React__default.createElement(ButtonGroup,{fullWidth:!0},React__default.createElement(core.Button,{color:r.type&&"image"!==r.type?"default":"primary",size:"small",onClick:function(){return i(__assign(__assign({},r),{type:"image"}))}},React__default.createElement(InsertPhotoIcon,null)),React__default.createElement(core.Button,{color:"video"===r.type?"primary":"default",size:"small",onClick:function(){return i(__assign(__assign({},r),{type:"video"}))}},React__default.createElement(MovieIcon,null)))),React__default.createElement(core.Grid,{item:!0,xs:6},React__default.createElement(core.TextField,{onChange:function(e){return t(e.target.value,"width")},value:r.width||"",label:"Width",InputLabelProps:{shrink:!0}})),React__default.createElement(core.Grid,{item:!0,xs:6},React__default.createElement(core.TextField,{onChange:function(e){return t(e.target.value,"height")},value:r.height||"",label:"Height",InputLabelProps:{shrink:!0}})),React__default.createElement(core.Grid,{item:!0,xs:12},React__default.createElement(ButtonGroup,{fullWidth:!0},React__default.createElement(core.Button,{color:"left"===r.alignment?"primary":"default",size:"small",onClick:function(){return i(__assign(__assign({},r),{alignment:"left"}))}},React__default.createElement(FormatAlignLeft,null)),React__default.createElement(core.Button,{color:"center"===r.alignment?"primary":"default",size:"small",onClick:function(){return i(__assign(__assign({},r),{alignment:"center"}))}},React__default.createElement(FormatAlignCenter,null)),React__default.createElement(core.Button,{color:"right"===r.alignment?"primary":"default",size:"small",onClick:function(){return i(__assign(__assign({},r),{alignment:"right"}))}},React__default.createElement(FormatAlignRight,null))))):null),React__default.createElement(core.Grid,{container:!0,item:!0,xs:12,direction:"row",justify:"flex-end"},e.data&&e.data.url?React__default.createElement(core.Button,{onClick:function(){return e.onConfirm(e.isMedia,"")}},React__default.createElement(DeleteIcon,null)):null,React__default.createElement(core.Button,{onClick:function(){return e.onConfirm(e.isMedia,r.url,r.width,r.height,r.alignment,r.type)}},React__default.createElement(CheckIcon,null))))))},UrlPopover$1=styles$5.withStyles(styles$3,{withTheme:!0})(UrlPopover),styles$4=function(e){var t=e.spacing,n=e.typography,o=e.palette;return styles$5.createStyles({root:{},container:{margin:getCompatibleSpacing(t,1,0,0,0),fontFamily:n.body1.fontFamily,fontSize:n.body1.fontSize,"& figure":{margin:0}},inheritFontSize:{fontSize:"inherit"},editor:{},editorContainer:{margin:getCompatibleSpacing(t,1,0,0,0),cursor:"text",width:"100%",padding:getCompatibleSpacing(t,0,0,1,0)},editorReadOnly:{borderBottom:"none"},error:{borderBottom:"2px solid red"},hidePlaceholder:{display:"none"},placeHolder:{color:o.grey[600]},linkPopover:{padding:getCompatibleSpacing(t,2,2,2,2)},linkTextField:{width:"100%"},anchorLink:{textDecoration:"underline",color:o.secondary.main},toolbar:{},inlineToolbar:{maxWidth:"180px",position:"absolute",padding:"5px",zIndex:10}})},blockRenderMap=Immutable.Map({blockquote:{element:"blockquote",wrapper:React__default.createElement(Blockquote$1,null)},"code-block":{element:"pre",wrapper:React__default.createElement(CodeBlock$1,null)}}),styleRenderMap={STRIKETROUGH:{textDecoration:"line-through"},HIGHLIGHT:{backgroundColor:"yellow"}},hasCommandModifier=draftJs.KeyBindingUtil.hasCommandModifier,findLinkEntities=function(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();return null!==t&&"LINK"===n.getEntity(t).getType()},t)},findDecoWithRegex=function(e,t,n){for(var o,a,r=t.getText();null!==(o=e.exec(r));)n(a=o.index,a+o[0].length)},useEditorState=function(e){var t=[{strategy:findLinkEntities,component:Link}];e.decorators&&e.decorators.forEach(function(n){return t.push({strategy:function(e,t){findDecoWithRegex(n.regex,e,t)},component:n.component})});var n=new draftJs.CompositeDecorator(t);return e.value?draftJs.EditorState.createWithContent(draftJs.convertFromRaw(JSON.parse(e.value)),n):draftJs.EditorState.createEmpty(n)},MUIRichTextEditor=function(i,e){var t,n,o,a,r=i.classes,l=i.controls,c=i.customControls,u=React.useState({}),s=u[0],d=u[1],f=React.useState(!1),m=f[0],g=f[1],p=React.useState(function(){return useEditorState(i)}),y=p[0],_=p[1],h=React.useState({style:void 0,block:void 0}),v=h[0],b=h[1],E=React.useState(""),R=E[0],k=E[1],C=React.useRef(null),S=React.useRef({start:0,end:0}),I=React.useRef(void 0),T=React.useRef(y);"undefined"==typeof FileReader?console.warn("Please use a browser that implements FileReader if you want to paste images into the editor."):((a=new FileReader).onabort=function(e){console.warn("File upload aborted. Reason: "+e)},a.onerror=function(e){console.error("There was an error uploading the file. "+e)}),React.useImperativeHandle(e,function(){return{focus:function(){U()},save:function(){w()},insertAtomicBlock:function(e,t){P(e,t)}}}),React.useEffect(function(){var e=useEditorState(i),t={},n=JSON.parse(JSON.stringify(styleRenderMap));return i.customControls&&i.customControls.forEach(function(e){"inline"===e.type&&e.inlineStyle?n[e.name.toUpperCase()]=e.inlineStyle:"block"===e.type&&e.blockWrapper&&(t[e.name.toUpperCase()]={element:"div",wrapper:e.blockWrapper})}),b({style:n,block:draftJs.DefaultDraftBlockRenderMap.merge(blockRenderMap,Immutable.Map(t))}),_(e),N(!0),function(){N()}},[i.value]),React.useEffect(function(){T.current=y},[y]),React.useEffect(function(){I.current=s.toolbarPosition},[s.toolbarPosition]);function B(e){var t=e.target.nodeName;"IMG"!==t&&"VIDEO"!==t&&setTimeout(function(){var e=T.current.getSelection();if(e.isCollapsed()||void 0!==I&&S.current.start===e.getStartOffset()&&S.current.end===e.getEndOffset()){var t=getSelectionInfo(T.current);return"IMAGE"===t.entityType?void G(t.block):void d(__assign(__assign({},s),{toolbarPosition:void 0}))}S.current={start:e.getStartOffset(),end:e.getEndOffset()};var n=C.current.editor,o=draftJs.getVisibleSelectionRect(window),a=n.getBoundingClientRect();if(o){var r={top:n.offsetTop-48+(o.top-a.top),left:n.offsetLeft+(o.left-a.left)};d(__assign(__assign({},s),{toolbarPosition:r}))}},1)}function D(e){_(e),i.onChange&&i.onChange(e)}function F(e,t,n){var o=getSelectionInfo(e),a=e.getCurrentContent(),r=o.linkKey,i=void 0;r&&(i=a.getEntity(r).getData()),d({urlData:i,urlKey:r,toolbarPosition:n?s.toolbarPosition:void 0,anchorUrlPopover:n?document.getElementById("mui-rte-"+t+"-control-toolbar"):document.getElementById("mui-rte-"+t+"-control"),urlIsMedia:"media"===t||void 0})}function M(e,t){F(t||y,"media",e)}function x(e,t,n,o){if("inline"===t)return $(e);if("block"===t)return K(e);switch(e){case"UNDO":_(draftJs.EditorState.undo(y));break;case"REDO":_(draftJs.EditorState.redo(y));break;case"LINK":!function(e){y.getSelection().isCollapsed()||F(y,"link",e)}(o);break;case"IMAGE":M(o);break;case"clear":!function(){var e=getSelectionInfo(y),t=y;e.inlineStyle.forEach(function(e){e&&(t=draftJs.RichUtils.toggleInlineStyle(t,e))}),t=draftJs.RichUtils.toggleBlockType(t,e.blockType),_(t)}();break;case"save":w();break;default:!function(e,t){if(i.customControls)for(var n=0,o=i.customControls;n<o.length;n++){var a=o[n];if(a.name.toUpperCase()===e){if(a.onClick){setTimeout(function(){return C.current.blur()},0);var r=a.onClick(y,a.name,document.getElementById(t));r?r.getSelection().isCollapsed()?_(r):O(r):y.getSelection().isCollapsed()||J()}break}}}(e,n)}}function L(n){var e=n.type;if(-1===["image/jpeg","image/png","image/gif"].indexOf(e))return console.error("You can't upload a "+e+" file!");a.onload=function(e){n.body=a.result;var t=null;i.onUpload&&(t=i.onUpload(n)),t&&t.then(function(e){A(e.publicUrl,n.width,n.height,"left","image")})},a.readAsDataURL(n)}var U=function(){g(!0),setTimeout(function(){return C.current.focus()},0)},w=function(){i.onSave&&i.onSave(JSON.stringify(draftJs.convertToRaw(y.getCurrentContent())))},P=function(e,t){var n=atomicBlockExists(e,i.customControls);if(n){var o=H(n.name.toUpperCase(),t,{selection:y.getCurrentContent().getSelectionAfter()});O(o)}},N=function(e){void 0===e&&(e=!1);var t=C.current.editor;t&&(t.removeEventListener("mouseup",B),e&&t.addEventListener("mouseup",B))},q=function(e){var t=s.urlKey;if(!e)return t?void function(){var e=y.getSelection();O(draftJs.RichUtils.toggleLink(y,e,null))}():void d(__assign(__assign({},s),{anchorUrlPopover:void 0}));var n=y.getCurrentContent(),o=null,a={url:e};if(t)n.replaceEntityData(t,a),o=draftJs.EditorState.push(y,n,"apply-entity");else{var r=n.createEntity("LINK","MUTABLE",a),i=r.getLastCreatedEntityKey(),l=draftJs.EditorState.set(y,{currentContent:r});o=draftJs.RichUtils.toggleLink(l,l.getSelection(),i)}O(o)},A=function(e,t,n,o,a){var r=s.urlKey;if(!e)return r&&function(){var e=y.getSelection().getStartKey(),t=y.getCurrentContent().getBlockForKey(e),n=removeBlockFromMap(y,t),o=draftJs.EditorState.push(y,n,"remove-range");_(o)}(),void d(__assign(__assign({},s),{anchorUrlPopover:void 0}));var i=y.getCurrentContent(),l={url:e,width:t,height:n,alignment:o,type:a};if(r){i.replaceEntityData(r,l);var c=draftJs.EditorState.push(y,i,"apply-entity");O(draftJs.EditorState.forceSelection(c,c.getCurrentContent().getSelectionAfter()))}else{c=H("IMAGE",l);O(draftJs.EditorState.forceSelection(c,c.getCurrentContent().getSelectionAfter()))}k("")},O=function(e){_(e),J(),d(__assign(__assign({},s),{anchorUrlPopover:void 0,urlKey:void 0,urlIsMedia:void 0,urlData:void 0}))},J=function(){setTimeout(function(){return C.current.blur()},0),setTimeout(function(){return C.current.focus()},1)},K=function(e){_(draftJs.RichUtils.toggleBlockType(y,e))},$=function(e){_(draftJs.RichUtils.toggleInlineStyle(y,e))},G=function(e){var t=draftJs.SelectionState.createEmpty(e.getKey()),n=draftJs.EditorState.forceSelection(T.current,t);T.current=n,k(e.getKey()),_(n),M(!1,n)},H=function(e,t,n){var o=y.getCurrentContent().createEntity(e,"IMMUTABLE",t),a=o.getLastCreatedEntityKey(),r=draftJs.EditorState.set(y,__assign({currentContent:o},n));return draftJs.AtomicBlockUtils.insertAtomicBlock(r,a," ")},z=void 0===i.toolbar||i.toolbar,W=i.inlineToolbarControls||["bold","italic","underline","clear"],j=void 0===i.readOnly||!i.readOnly,Y=i.id||"mui-rte",Q="",V=null;m||y.getCurrentContent().hasText()||(V=React__default.createElement("div",{className:classNames(r.editorContainer,r.placeHolder,(t={},t[r.error]=i.error,t)),onClick:U},i.label||""),Q=r.hidePlaceholder);return React__default.createElement("div",{id:Y+"-root",className:r.root},React__default.createElement("div",{id:Y+"-container",className:classNames(r.container,(n={},n[r.inheritFontSize]=i.inheritFontSize,n))},i.inlineToolbar&&j&&s.toolbarPosition?React__default.createElement(core.Paper,{className:r.inlineToolbar,style:{top:s.toolbarPosition.top,left:s.toolbarPosition.left}},React__default.createElement(Toolbar,{id:Y,editorState:y,onClick:x,controls:W,customControls:c,inlineMode:!0})):null,j||z?React__default.createElement(Toolbar,{id:Y,editorState:y,onClick:x,controls:l,customControls:c,className:r.toolbar,disabled:!j}):null,V,React__default.createElement("div",{id:Y+"-editor",className:r.editor},React__default.createElement("div",{id:Y+"-editor-container",className:classNames(Q,r.editorContainer,(o={},o[r.editorReadOnly]=!j,o[r.error]=i.error,o)),onClick:U,onBlur:function(){g(!1),s.anchorUrlPopover||d(__assign(__assign({},s),{toolbarPosition:void 0}))}},React__default.createElement(draftJs.Editor,__assign({customStyleMap:v.style,blockRenderMap:v.block,blockRendererFn:function(e){if("atomic"===e.getType()){var t=y.getCurrentContent(),n=e.getEntityAt(0);if(n){var o=t.getEntity(n).getType();if("IMAGE"===o)return{component:Media$1,editable:!1,props:{onClick:G,readOnly:i.readOnly,focusKey:R}};var a=atomicBlockExists(o.toLowerCase(),i.customControls);return a?{component:a.atomicComponent,editable:!1,props:t.getEntity(e.getEntityAt(0)).getData()}:null}}return null},editorState:y,onChange:D,readOnly:i.readOnly,handleKeyCommand:function(t,e){var n=draftJs.RichUtils.handleKeyCommand(e,t);if(n)return D(n),"handled";if(i.keyCommands){var o=i.keyCommands.find(function(e){return e.name===t});if(o){var a=o.callback(e);return D(a),"handled"}}return"not-handled"},keyBindingFn:function(t){if(hasCommandModifier(t)&&i.keyCommands){var e=i.keyCommands.find(function(e){return e.key===t.keyCode});if(e)return e.name}return draftJs.getDefaultKeyBinding(t)},handlePastedFiles:function(e){if(a)for(var t=0,n=e.length;t<n;t++)L(e[t]);return"not-handled"},ref:C},i.draftEditorProps)))),s.anchorUrlPopover?React__default.createElement(UrlPopover$1,{data:s.urlData,anchor:s.anchorUrlPopover,onConfirm:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e?A.apply(void 0,t):q.apply(void 0,t)},isMedia:s.urlIsMedia}):null))},MUIRichTextEditor$1=styles$5.withStyles(styles$4,{withTheme:!0,name:"MUIRichTextEditor"})(React.forwardRef(MUIRichTextEditor));exports.default=MUIRichTextEditor$1;
